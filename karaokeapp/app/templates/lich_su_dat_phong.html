{% extends "base.html" %}

{% block title %}L·ªãch s·ª≠ ƒë·∫∑t ph√≤ng{% endblock %}

{% block content %}
<h2 style="text-align:center; color:#007BFF; margin-bottom:20px;">üìú L·ªãch s·ª≠ ƒë·∫∑t ph√≤ng</h2>

{% if dat_phongs %}
<table style="width:100%; border-collapse:collapse; font-family:Segoe UI; font-size:14px;">
    <thead>
    <tr style="background:#007BFF; color:white;">
        <th style="padding:10px;">Ph√≤ng</th>
        <th>Ng√†y gi·ªù</th>
        <th>S·ªë ng∆∞·ªùi</th>
        <th>Tr·∫°ng th√°i</th>
        <th>T·ªïng ti·ªÅn</th>
        <th>D·ªãch v·ª•</th>
        <th>H√†nh ƒë·ªông</th>
    </tr>
    </thead>
    <tbody>
    {% for dp in dat_phongs %}
    <tr style="border-bottom:1px solid #ddd; {% if loop.index % 2 == 0 %}background:#f9f9f9;{% endif %}">
        <td style="padding:8px;">{{ dp.phong.TenPhong }}</td>
        <td style="padding:8px;">
            {{ dp.ThoiGianBatDau.strftime("%d/%m/%Y %H:%M") }} -
            {{ dp.ThoiGianKetThuc.strftime("%H:%M") }}
        </td>
        <td style="padding:8px;">{{ dp.SoNguoi }}</td>
        <td style="padding:8px;">{{ dp.TrangThai.replace("_"," ") }}</td>
        <td style="padding:8px;">
            {% if dp.hoa_don %}
            {{ dp.hoa_don.TongTien or 0 }} ƒë
            {% else %}
            Ch∆∞a thanh to√°n
            {% endif %}
        </td>
        <td style="padding:8px;">
            {% if dp.chi_tiet_dv %}
            <ul style="margin:0; padding-left:15px;">
                {% for ct in dp.chi_tiet_dv %}
                <li>{{ ct.dich_vu.TenDichVu }} x{{ ct.SoLuong }}</li>
                {% endfor %}
            </ul>
            {% else %}
            -
            {% endif %}
        </td>
        <td style="padding:8px; text-align:center;">
            {% if dp.TrangThai == 'CHO_XAC_NHAN' %}
            <form method="post" action="{{ url_for('huy_dat_phong', ma_dat_phong=dp.MaDatPhong) }}"
                  onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën h·ªßy ƒë·∫∑t ph√≤ng n√†y?');">
                <button type="submit"
                        style="padding:5px 10px; background:#dc3545; color:white; border:none; border-radius:4px; cursor:pointer;">
                    H·ªßy
                </button>
            </form>
            {% else %}
            -
            {% endif %}
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p style="text-align:center; color:#555; margin-top:30px;">Ch∆∞a c√≥ ƒë·∫∑t ph√≤ng n√†o.</p>
{% endif %}

<div style="text-align:center; margin-top:20px;">
    <a href="{{ url_for('index') }}"
       style="padding:8px 18px; background:#007BFF; color:white; border-radius:6px; text-decoration:none;">‚¨Ö Quay
        l·∫°i</a>
</div>
{% endblock %}
