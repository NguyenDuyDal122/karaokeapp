{% extends "base.html" %}

{% block title %}ƒê·∫∑t ph√≤ng - {{ room.TenPhong }}{% endblock %}

{% block content %}

<style>
    label {
        font-weight: 600;
        margin-bottom: 6px;
        display: inline-block;
    }

    input, select {
        width: 100%;
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid #ced4da;
        margin-bottom: 18px;
        font-size: 15px;
    }

    input:focus, select:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 6px rgba(0,123,255,0.4);
    }

    button {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: none;
        font-size: 16px;
        background: #007BFF;
        color: white;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
    }

    button:hover {
        background: #0056b3;
    }

    .service-item {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 5px;
    }
</style>

<h2 style="color:#007BFF; text-align:center; margin-bottom: 20px;">
    üé§ ƒê·∫∑t ph√≤ng: {{ room.TenPhong }}
</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
<div style="margin: 10px auto; width: 90%;">
    {% for category, message in messages %}
    <div class="alert alert-{{ category }} flash-msg" style="
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-weight: 500;
            {% if category == 'success' %}
                background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb;
            {% elif category == 'danger' %}
                background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb;
            {% elif category == 'warning' %}
                background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba;
            {% else %}
                background-color: #cce5ff; color: #004085; border: 1px solid #b8daff;
            {% endif %}
        ">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}
{% endwith %}

<form method="post">
    <label>Ng√†y ƒë·∫∑t:</label>
    <input type="date" name="ngay_dat" value="{{ dat_phong_info.get('ngay_dat', '') }}" required>

    <label>Gi·ªù b·∫Øt ƒë·∫ßu:</label>
    <input type="time" name="gio_bat_dau" value="{{ dat_phong_info.get('gio_bat_dau', '') }}" required>

    <label>Gi·ªù k·∫øt th√∫c:</label>
    <input type="time" name="gio_ket_thuc" value="{{ dat_phong_info.get('gio_ket_thuc', '') }}" required>

    <label>S·ªë l∆∞·ª£ng ng∆∞·ªùi (T·ªëi ƒëa {{ room.SucChua }}):</label>
    <input type="number" name="so_nguoi" min="1" max="{{ room.SucChua }}"
           value="{{ dat_phong_info.get('so_nguoi', '') }}" required>

    <button type="submit" name="them_dich_vu" value="1" style="background-color:#28a745;margin-bottom:20px;">‚ûï D·ªãch v·ª•</button>

    <label>D·ªãch v·ª• ƒë√£ ch·ªçn:</label>
    {% if selected_services %}
    {% set so_luong_map = {} %}
    {% for item in selected_services_data %}
    {% set _ = so_luong_map.update({item['id']: item['so_luong']}) %}
    {% endfor %}

    <div style="display: flex; flex-wrap: wrap; gap: 12px;">
        {% for dv in selected_services %}
        {% set so_luong = so_luong_map.get(dv.MaDichVu, 1) %}
        <div style="
                border: 1px solid #ccc;
                border-radius: 8px;
                padding: 8px;
                width: 150px;
                text-align: center;
                background: #f9f9f9;
            ">
            {% if dv.HinhAnh %}
            <img src="{{ url_for('static', filename=dv.HinhAnh) }}"
                 alt="{{ dv.TenDichVu }}"
                 style="width: 100%; height: 100px; object-fit: cover; border-radius: 6px; margin-bottom: 6px;">
            {% endif %}
            <h5 style="margin: 0; font-size: 14px;">{{ dv.TenDichVu }}</h5>
            <p style="margin: 4px 0; font-size: 13px;">S·ªë l∆∞·ª£ng: {{ so_luong }}</p>
            <p style="margin: 0; font-size: 13px;">{{ dv.DonGia }}ƒë</p>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>Ch∆∞a c√≥ d·ªãch v·ª• n√†o ƒë∆∞·ª£c ch·ªçn.</p>
    {% endif %}

    <!-- N√∫t thanh to√°n -->
    <button type="submit" name="thanh_toan" value="1">‚úÖ Thanh to√°n</button>
</form>

<br>
<a href="{{ url_for('index') }}">‚¨Ö Quay l·∫°i</a>

{% endblock %}
