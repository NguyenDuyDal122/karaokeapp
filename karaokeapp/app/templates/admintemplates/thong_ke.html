{% extends "admintemplates/admin_base.html" %}
{% block title %}Thá»‘ng kÃª doanh thu{% endblock %}

{% block content %}
<h3 class="mb-4">ğŸ“Š Thá»‘ng kÃª doanh thu</h3>

<!-- FORM CHá»ŒN LOáº I -->
<form method="post" class="row mb-4">
    <div class="col-md-4">
        <select name="loai" class="form-select">
            <option value="ngay" {% if loai=='ngay' %}selected{% endif %}>Theo ngÃ y</option>
            <option value="thang" {% if loai=='thang' %}selected{% endif %}>Theo thÃ¡ng</option>
            <option value="nam" {% if loai=='nam' %}selected{% endif %}>Theo nÄƒm</option>
        </select>
    </div>
    <div class="col-md-2">
        <button class="btn btn-primary">ğŸ“Š Thá»‘ng kÃª</button>
    </div>
</form>

<!-- Tá»”NG DOANH THU -->
<div class="alert alert-success fs-5">
    ğŸ’° <b>Tá»•ng doanh thu:</b> {{ "{:,.0f}".format(tong_dt) }} â‚«
</div>

<div class="row">
    <!-- Báº¢NG -->
    <div class="col-md-6">
        <table class="table table-bordered table-hover">
            <thead class="table-dark text-center">
                <tr>
                    <th>Thá»i gian</th>
                    <th>Doanh thu</th>
                </tr>
            </thead>
            <tbody>
                {% for tg, tien in thong_ke %}
                <tr class="text-center">
                    <td>{{ tg }}</td>
                    <td class="text-end fw-bold text-success">
                        {{ "{:,.0f}".format(tien) }} â‚«
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- BIá»‚U Äá»’ -->
    <div class="col-md-6">
        <canvas id="chartDoanhThu"></canvas>
    </div>
</div>

<!-- CHART.JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('chartDoanhThu');

new Chart(ctx, {
    type: 'bar',
    data: {
        labels: {{ labels | tojson }},
        datasets: [{
            label: 'Doanh thu (VNÄ)',
            data: {{ values | tojson }},
            backgroundColor: 'rgba(54, 162, 235, 0.7)'
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display: false }
        },
        scales: {
            y: {
                ticks: {
                    callback: value => value.toLocaleString() + ' â‚«'
                }
            }
        }
    }
});
</script>
{% endblock %}
